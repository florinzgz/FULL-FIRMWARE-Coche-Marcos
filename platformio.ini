; ============================================================================
; PlatformIO Configuration for High-Performance ESP32-S3 N16R8
; Project: Smart Car HUD & Control System v2.15.0
; üîí BLINDADO: PSRAM Octal, 16MB Flash, Safe TFT Mapping
; ============================================================================

[env:esp32-s3-devkitc1-n16r8]
platform = espressif32
board = esp32-s3-devkitc1-n16r8
framework = arduino

; üõ†Ô∏è CONFIGURACI√ìN DE MEMORIA Y PARTICIONES
; -----------------------------------------
; Forzamos el uso de tus 16MB de Flash y 8MB de PSRAM Octal
board_build.partitions = partitions.csv
board_build.sdkconfig = sdkconfig/n16r8.defaults
board_build.arduino.memory_type = qio_opi
board_build.flash_mode = qio
board_build.f_flash = 80000000L
board_build.f_cpu = 240000000L

; üö© BANDERAS DE COMPILACI√ìN (BUILD FLAGS)
; -----------------------------------------
build_flags = 
    ; --- Diagn√≥stico y Depuraci√≥n ---
    -DCORE_DEBUG_LEVEL=5
    -DBOARD_HAS_PSRAM
    -mfix-esp32-psram-cache-issue
    -DARDUINO_USB_CDC_ON_BOOT=0

    ; --- TFT_eSPI: Mapeo Seguro N16R8 (GPIO 13-17) ---
    ; üîí Evita conflictos con Flash Interna (10-12) y PSRAM (33-37)
    -DUSER_SETUP_LOADED=1
    -DST7796_DRIVER=1
    -DTFT_WIDTH=320
    -DTFT_HEIGHT=480
    -DTFT_MISO=-1
    -DTFT_MOSI=13
    -DTFT_SCLK=14
    -DTFT_CS=15
    -DTFT_DC=16
    -DTFT_RST=17
    -DTFT_BL=42
    -DTFT_BACKLIGHT_ON=1
    
    ; --- Velocidades de Bus ---
    -DSPI_FREQUENCY=40000000
    -DSPI_READ_FREQUENCY=20000000
    -DSPI_TOUCH_FREQUENCY=2500000
    -DI2C_FREQUENCY=400000

    ; --- Configuraci√≥n T√°ctil ---
    -DTOUCH_CS=21

    ; --- Fuentes y Gr√°ficos (HUD) ---
    -DLOAD_GLCD=1
    -DLOAD_FONT2=1
    -DLOAD_FONT4=1
    -DLOAD_FONT6=1
    -DLOAD_FONT7=1
    -DLOAD_FONT8=1
    -DLOAD_GFXFF=1
    -DSMOOTH_FONT=1

; üìö DEPENDENCIAS DE BIBLIOTECAS
; -----------------------------------------
lib_deps = 
    adafruit/Adafruit MCP23017 Arduino Library@^2.3.2
    dfrobot/DFRobotDFPlayerMini@^1.0.6
    adafruit/Adafruit PWM Servo Driver Library@^3.0.2
    bodmer/TFT_eSPI@^2.5.43
    fastled/FastLED@^3.10.3
    milesburton/DallasTemperature@^4.0.6
    robtillaart/INA226@^0.6.6

; üîå MONITOR Y VELOCIDAD DE CARGA
; -----------------------------------------
monitor_speed = 115200
upload_speed = 921600
monitor_filters = esp32_exception_decoder
